function [R]=quat_rot(Q)
%{
Q=q0+q1*i+q2*j+q3*k 
Q=[q0,q1,q2,q3]
%} 
R(:,1)=[(1-2*(Q(3)^2)-2*(Q(4)^2)),;
    (2*Q(2)*Q(3)+2*Q(4)*Q(1)),;
    (2*Q(2)*Q(4)-2*Q(3)*Q(1))]';
R(:,2)=[(2*Q(2)*Q(3)-2*Q(4)*Q(1)),;
    (1-2*(Q(2)^2)-2*(Q(4)^2)),;
    (2*Q(3)*Q(4)+2*Q(2)*Q(1))]';
R(:,3)=[(2*Q(2)*Q(4)+2*Q(3)*Q(1)),;
    (2*Q(3)*Q(4)-2*Q(2)*Q(1)),;
    (1-2*(Q(2)^2)-2*(Q(3)^2))]';
end